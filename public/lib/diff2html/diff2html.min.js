var diff2html=function(){var a;return a=function(){function b(){}function m(a){return a.slice(0).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\t/g,"    ")}function n(a,b){return 0===a.indexOf(b)}function o(a){return a?a:""}function p(a,b){var c=jsdiff.diffString(a.substr(1),b.substr(1));return{o:a.charAt(0)+k(c),n:b.charAt(0)+l(c)}}var a={INSERTS:"d2h-ins",DELETES:"d2h-del",CONTEXT:"d2h-cntx",INFO:"d2h-info"};b.prototype.getPrettyHtmlFromDiff=function(a){var b=c(a);return d(b)},b.prototype.getJsonFromDiff=function(a){return c(a)},b.prototype.getPrettyHtmlFromJson=function(a){return d(a)},b.prototype.getPrettySideBySideHtmlFromDiff=function(a){console.log(a);var b=c(a);return g(b)},b.prototype.getPrettySideBySideHtmlFromJson=function(a){return g(a)};var q,c=function(b){var c=[],d=null,e=null,f=null,g=null,h=function(){e&&(d.blocks.push(e),e=null)},i=function(){d&&(c.push(d),d=null)},j=function(a){h(),i(),d={},d.blocks=[],d.deletedLines=0,d.addedLines=0;var b=/^Index: (.*)$/.exec(a);d.oldName=b[1],d.newName=b[2]},k=function(a){h();var b;(b=/^(@@ -(\d+),(\d+) \+(\d+),(\d+) @@).*/.exec(a))?(f=b[2],g=b[4]):(f=0,g=0),e={},e.lines=[],e.oldStartLine=f,e.newStartLine=g,e.header=a},l=function(b){var c={};c.content=b,n(b,"+")?(d.addedLines++,c.type=a.INSERTS,c.oldNumber=null,c.newNumber=g++,e.lines.push(c)):n(b,"-")?(d.deletedLines++,c.type=a.DELETES,c.oldNumber=f++,c.newNumber=null,e.lines.push(c)):(c.type=a.CONTEXT,c.oldNumber=f++,c.newNumber=g++,e.lines.push(c))},m=b.split("\n");return m.forEach(function(a){!a||n(a,"*")||n(a,"new")||n(a,"---")||n(a,"+++")||(n(a,"Index")?j(a):d&&n(a,"@@")?k(a):e&&l(a))}),h(),i(),c},d=function(a){return'<div class="d2h-wrapper">\n'+a.map(function(a){return'<div class="d2h-file-wrapper">\n     <div class="d2h-file-header">\n       <div class="d2h-file-stats">\n         <span class="d2h-lines-added">+'+a.addedLines+"</span>\n"+'         <span class="d2h-lines-deleted">-'+a.deletedLines+"</span>\n"+"       </div>\n"+'       <div class="d2h-file-name">'+j(a.oldName,a.newName)+"</div>\n"+"     </div>\n"+'     <div class="d2h-file-diff">\n'+'       <div class="d2h-code-wrapper">\n'+'         <table class="d2h-diff-table">\n'+'           <tbody class="d2h-diff-tbody">\n'+"         "+e(a)+"           </tbody>\n"+"         </table>\n"+"       </div>\n"+"     </div>\n"+"   </div>\n"}).join("\n")+"</div>\n"},e=function(b){return b.blocks.map(function(b){for(var c='<tr>\n  <td class="d2h-code-linenumber '+a.INFO+'" colspan="2"></td>\n'+'  <td class="'+a.INFO+'">'+'    <div class="d2h-code-line '+a.INFO+'">'+m(b.header)+"</div>"+"  </td>\n"+"</tr>\n",d=0;d<b.lines.length;d++){var e=b.lines[d-1],g=b.lines[d],h=b.lines[d+1],i=b.lines[d+2],j=g.type==a.DELETES&&h&&h.type==a.INSERTS&&(!i||i&&i.type!=a.INSERTS)&&(!e||e&&e.type!=a.DELETES),k=m(g.content);if(j){var l=m(h.content),n=p(k,l);c+=f(g.type,g.oldNumber,g.newNumber,n.o)+f(h.type,h.oldNumber,h.newNumber,n.n),d++}else c+=f(g.type,g.oldNumber,g.newNumber,k)}return c}).join("\n")},f=function(a,b,c,d){return'<tr>\n  <td class="d2h-code-linenumber '+a+'">'+'    <div class="line-num1">'+o(b)+"</div>"+'    <div class="line-num2">'+o(c)+"</div>"+"  </td>\n"+'  <td class="'+a+'">'+'    <div class="d2h-code-line '+a+'">'+d+"</div>"+"  </td>\n"+"</tr>\n"},g=function(a){return'<div class="d2h-wrapper">\n'+a.map(function(a){var b=h(a);return'<div class="d2h-file-wrapper">\n     <div class="d2h-file-header">\n       <div class="d2h-file-stats">\n         <span class="d2h-lines-added">+'+a.addedLines+"</span>\n"+'         <span class="d2h-lines-deleted">-'+a.deletedLines+"</span>\n"+"       </div>\n"+'       <div class="d2h-file-name">'+j(a.oldName,a.newName)+"</div>\n"+"     </div>\n"+'     <div class="d2h-files-diff">\n'+'       <div class="d2h-file-side-diff">\n'+'         <div class="d2h-code-wrapper">\n'+'           <table class="d2h-diff-table">\n'+'             <tbody class="d2h-diff-tbody">\n'+"           "+b.left+"             </tbody>\n"+"           </table>\n"+"         </div>\n"+"       </div>\n"+'       <div class="d2h-file-side-diff">\n'+'         <div class="d2h-code-wrapper">\n'+'           <table class="d2h-diff-table">\n'+'             <tbody class="d2h-diff-tbody">\n'+"           "+b.right+"             </tbody>\n"+"           </table>\n"+"         </div>\n"+"       </div>\n"+"     </div>\n"+"   </div>\n"}).join("\n")+"</div>\n"},h=function(b){var c={};return c.left="",c.right="",b.blocks.forEach(function(b){c.left+='<tr>\n  <td class="d2h-code-side-linenumber '+a.INFO+'"></td>\n'+'  <td class="'+a.INFO+'" colspan="3">'+'    <div class="d2h-code-side-line '+a.INFO+'">'+m(b.header)+"</div>"+"  </td>\n"+"</tr>\n",c.right+='<tr>\n  <td class="d2h-code-side-linenumber '+a.INFO+'"></td>\n'+'  <td class="'+a.INFO+'" colspan="3">'+'    <div class="d2h-code-side-line '+a.INFO+'"></div>'+"  </td>\n"+"</tr>\n";for(var d=0;d<b.lines.length;d++){var e=b.lines[d-1],f=b.lines[d],g=b.lines[d+1],h=b.lines[d+2],j=f.type==a.DELETES&&g&&g.type==a.INSERTS&&(!h||h&&h.type!=a.INSERTS)&&(!e||e&&e.type!=a.DELETES),k=m(f.content);if(j){var l=m(g.content),n=p(k,l);c.left+=i(f.type,f.oldNumber,n.o),c.right+=i(g.type,g.newNumber,n.n),d++}else f.type==a.DELETES?(c.left+=i(f.type,f.oldNumber,k),c.right+=i(a.CONTEXT,"","","")):f.type==a.INSERTS?(c.left+=i(a.CONTEXT,"","",""),c.right+=i(f.type,f.newNumber,k)):(c.left+=i(f.type,f.oldNumber,k),c.right+=i(f.type,f.newNumber,k))}}),c},i=function(a,b,c){return'<tr>\n    <td class="d2h-code-side-linenumber '+a+'">'+b+"</td>\n"+'    <td class="'+a+'">'+'      <div class="d2h-code-side-line '+a+'">'+c+"</div>"+"    </td>\n"+"  </tr>\n"},j=function(a,b){var c=b?" -> "+b:"";return a===b?b:a+c},k=function(a){return a.replace(/(<ins>((.|\n)*?)<\/ins>)/g,"")},l=function(a){return a.replace(/(<del>((.|\n)*?)<\/del>)/g,"")};return{getInstance:function(){return void 0===q&&(q=new b,q.constructor=null),q}}}(),a.getInstance()}();