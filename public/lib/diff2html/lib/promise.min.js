!function(a){function b(){this._callbacks=[]}function c(a){function g(a){return function(){e+=1,f[a]=Array.prototype.slice.call(arguments),e===d&&c.done(f)}}for(var c=new b,d=a.length,e=0,f=[],h=0;d>h;h++)a[h].then(g(h));return c}function d(a,c){var e=new b;return 0===a.length?e.done.apply(e,c):a[0].apply(null,c).then(function(){a.splice(0,1),d(a,arguments).then(function(){e.done.apply(e,arguments)})}),e}function e(a){var b="";if("string"==typeof a)b=a;else{var c=encodeURIComponent;for(var d in a)a.hasOwnProperty(d)&&(b+="&"+c(d)+"="+c(a[d]))}return b}function f(){var a;if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){a=new ActiveXObject("Microsoft.XMLHTTP")}return a}function g(a,c,d,g){function n(){j.abort(),h.done(i.ETIMEOUT,"",j)}var j,k,h=new b;d=d||{},g=g||{};try{j=f()}catch(l){return h.done(i.ENOXHR,""),h}k=e(d),"GET"===a&&k&&(c+="?"+k,k=null),j.open(a,c),j.setRequestHeader("Content-type","application/x-www-form-urlencoded");for(var m in g)g.hasOwnProperty(m)&&j.setRequestHeader(m,g[m]);var o=i.ajaxTimeout;if(o)var p=setTimeout(n,o);return j.onreadystatechange=function(){if(o&&clearTimeout(p),4===j.readyState){var a=!j.status||(j.status<200||j.status>=300)&&304!==j.status;h.done(a,j.responseText,j)}},j.send(k),h}function h(a){return function(b,c,d){return g(a,b,c,d)}}b.prototype.then=function(a,c){var d;return this._isdone?d=a.apply(c,this.result):(d=new b,this._callbacks.push(function(){var b=a.apply(c,arguments);b&&"function"==typeof b.then&&b.then(d.done,d)})),d},b.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var a=0;a<this._callbacks.length;a++)this._callbacks[a].apply(null,arguments);this._callbacks=[]};var i={Promise:b,join:c,chain:d,ajax:g,get:h("GET"),post:h("POST"),put:h("PUT"),del:h("DELETE"),ENOXHR:1,ETIMEOUT:2,ajaxTimeout:0};"function"==typeof define&&define.amd?define(function(){return i}):a.promise=i}(this);